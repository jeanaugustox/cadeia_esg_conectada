
import sys
from collections import Counter

certificados_registrados = []

print("=" * 15 + "Cadeia ESG Conectada" + "=" * 15)
print("Bem-vindo(a) à plataforma ESG Conectada! ")

while True:
    print("\n--- MENU PRINCIPAL ---")
    print("1. Registrar Novo Certificado")
    print("2. Ver Ranking de Empresas (Total de Certificados)")
    print("3. Sair")
    
    escolha = input("Escolha uma opção (1-3): ")

    if escolha == "1":
        print("\nPreencha Abaixo os requisitos para enviar a sua certificação ")
        
        empresa = input("Digite o nome da Empresa: ").title() 
        
        certificado = input("Digite o nome do seu certificado ESG: ").title()
        categoria = input("Digite a categoria do seu certificado: ").title()
        emitido = input("Digite onde foi emitido (Fonte oficial): ").title()
        validade = input("Digite a data de validade: ")
        emissao = input("Digite a data de emissão: ")
        
        print(f"\nDe acordo com as informações fornecidas: \nEmpresa: {empresa} \nO nome do seu certificado é {certificado} \nDa categoria {categoria} \nEmitido por {emitido} \nEmissão em {emissao} \nVálido até {validade}")
        print("Obrigado por preencher os dados do seu certificado! ")
        
        opcao = input("Você confirma a conformidade e validade das informações? (S/N): ").lower()
        
        if opcao == "s":
            observacao_detalhe = ""
            observacao = input("Deseja destacar alguma observação? (S/N): ").lower()
            
            if observacao == "s":
                detalhe = input("Digite a sua observação: ")
                observacao_detalhe = detalhe
                print(f"Sua observação foi registrada com Sucesso!")
            else:
                print("Nenhuma observação registrada.")

            novo_registro = {
                "empresa": empresa,
                "certificado": certificado,
                "categoria": categoria,
                "emitido": emitido,
                "validade": validade,
                "emissao": emissao,
                "observacao": observacao_detalhe
            }
            certificados_registrados.append(novo_registro)
            
            print("Certificado enviado com Sucesso! ")
        
        else:
            print("Operação cancelada. Por favor revise os dados.")

    elif escolha == "2":
        print("\n" + "=" * 10 + " Ranking Total de Certificados " + "=" * 10)
        
        if not certificados_registrados:
            print("Nenhum certificado registrado ainda.")
        else:
            lista_empresas = [cert["empresa"] for cert in certificados_registrados]
            
            ranking = Counter(lista_empresas)
            
            print(f"{'Pos.':<5} | {'Empresa':<30} | {'Qtd. Certificados':<20}")
            print("-" * 57)
            for i, (empresa, contagem) in enumerate(ranking.most_common(), 1):
                print(f"{i:<5} | {empresa:<30} | {contagem:<20}")

    elif escolha == "3":
        print("Obrigado por utilizar a plataforma ESG Conectada!")
        break 

    else:
        print("Opção inválida. Por favor, escolha de 1 a 3.")
